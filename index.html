<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JG Force Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
<style>
html, body {
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto; /* scroll solo se necessario */
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Orbitron', sans-serif;
  color: #f5f5f5;
  max-width: 600px;
  margin: 0 auto;
  padding: 30px 20px;
  text-align: center;
  position: relative;
  min-height: 100vh; /* almeno l'altezza della finestra */
  background: black;
}

#stars { 
  position: absolute; /* canvas non fissa piÃ¹ */
  top:0; left:0; width:100%; height:100%; z-index: -1; 
}

#chart { display: block; margin: 20px auto; }

#ricomincia { display: block; margin: 20px auto; }

h1 { color: #ffe81f; letter-spacing:2px; margin-bottom:10px; }
h2 { margin-top:0; }

@keyframes fadeInUp { 0%{opacity:0;transform:translateY(30px);} 100%{opacity:1;transform:translateY(0);} }
@keyframes fadeOutDown { 0%{opacity:1;transform:translateY(0);} 100%{opacity:0;transform:translateY(30px);} }

.domanda { display:none; background: rgba(0,0,0,0.6); padding: 15px; border-radius:12px; margin-bottom:15px; }
.domanda.attiva { display:block; animation: fadeInUp 0.5s ease forwards; }
.domanda.esci { animation: fadeOutDown 0.5s ease forwards; }

label { display:block; background: rgba(255,255,255,0.05); border-radius:8px; padding:12px; margin:12px 0; cursor:pointer; transition: all 0.3s; }
input[type="radio"] { display:none; }

label:hover { background: rgba(255,255,255,0.15); }

button {
  margin-top:25px; padding:16px 36px; font-size:18px; font-family:'Orbitron',sans-serif;
  border:none; border-radius:30px; color:white; cursor:pointer;
  background: linear-gradient(90deg,#3f8cff,#1b3cff); box-shadow:0 0 15px rgba(63,140,255,0.6);
  position: relative; overflow:hidden; transition: all 0.3s ease;
}
button::before {
  content:""; position:absolute; top:0; left:0; right:0; bottom:0; border-radius:30px;
  box-shadow:0 0 30px #3f8cff,0 0 60px #3f8cff inset; opacity:0.6; transition: all 0.3s ease; pointer-events:none;
}
button:active::before { box-shadow:0 0 60px #3f8cff,0 0 100px #3f8cff inset; opacity:1; }

#progress-container { width:100%; height:8px; background:#222; border-radius:4px; overflow:hidden; margin:20px 0 30px;}
#progress-bar { height:100%; width:0%; background: linear-gradient(90deg,#3f8cff,#ffe81f,#c62828); transition: width 0.4s ease; }

#output { margin-top:20px; padding:15px; border-radius:12px; background: rgba(0,0,0,0.6); white-space: pre-line; text-align:left; position:relative; }

#socials { margin-top:30px; display:none; justify-content:center; gap:30px; }

@media(max-width:480px){
  body{padding:20px 15px;} h1{font-size:24px;} h2{font-size:18px;} label{font-size:16px;} 
  #progress-container{height:6px;margin:15px 0 25px;} 
}
</style>
</head>
<body>
  <!-- Logo in cima -->
<img src="logo.png" style="width:150px; height:auto; display:block; margin: 0 auto 20px;">

<canvas id="stars"></canvas>
<h1>Quiz della Forza</h1>
<p style="font-size:12px; opacity:0.7;">Scopri se sei Jedi, Sith o Jedi Grigio</p>
<div id="progress-container"><div id="progress-bar"></div></div>

<!-- Domande -->
<div class="domanda attiva">
  <h2>Domanda 1: Quale lato della Forza ti attrae di piÃ¹?</h2>
  <label data-value="jedi">La luce e l'equilibrio</label>
  <label data-value="sith">Il potere e la passione</label>
  <label data-value="grigio">Entrambi, a seconda del momento</label>
</div>

<div class="domanda">
  <h2>Domanda 2: Cosa faresti se qualcuno ti provocasse?</h2>
  <label data-value="jedi">Rimango calmo e ragiono</label>
  <label data-value="sith">Colpirei subito con forza</label>
  <label data-value="grigio">Dipende dalla situazione</label>
</div>

<button id="next">Avanti</button>
<div id="output"></div>
<canvas id="chart" width="300" height="300" style="margin-top:20px;"></canvas>
<button id="ricomincia" style="display:none;">ðŸ”„ Ricomincia il Quiz</button>
<div id="socials"></div>

<script>
let domandaCorrente=0;
const domande=document.querySelectorAll(".domanda");
const nextBtn=document.getElementById("next");
const ricominciaBtn=document.getElementById("ricomincia");
const progressBar=document.getElementById("progress-bar");
const chartCanvas=document.getElementById("chart");
const ctxChart=chartCanvas.getContext("2d");
const socialsDiv=document.getElementById("socials");
let punteggi={jedi:0,sith:0,grigio:0};
let selectedValue="";

function aggiornaProgress(){ progressBar.style.width=((domandaCorrente)/domande.length*100)+"%"; }

domande.forEach((dom, i)=>{
  dom.querySelectorAll("label").forEach(l=>{
    l.addEventListener("click",()=>{
      dom.querySelectorAll("label").forEach(lbl=>lbl.style.background="rgba(255,255,255,0.05)");
      l.style.background="rgba(255,232,31,0.4)";
      selectedValue=l.dataset.value;
    });
  });
});

nextBtn.addEventListener("click",function(){
  if(!selectedValue){ alert("Seleziona una risposta!"); return; }
  punteggi[selectedValue]++;

  const currentDomanda = domande[domandaCorrente];
  currentDomanda.classList.add("esci"); 
  setTimeout(()=>{
    currentDomanda.classList.remove("attiva","esci");
    domandaCorrente++;
    if(domandaCorrente<domande.length){
      domande[domandaCorrente].classList.add("attiva"); 
    } else { mostraRisultato(); }
    aggiornaProgress();
    selectedValue=""; // reset selezione
  },500);
});

function mostraRisultato(){
  const output=document.getElementById("output");
  let esito="âš–ï¸ Jedi Grigio â€“ cammini tra luce e oscuritÃ ";
  let colore="#a080ff";
  if(punteggi.jedi>punteggi.sith && punteggi.jedi>punteggi.grigio){ esito="ðŸŸ¦ Jedi â€“ segui la luce e lâ€™equilibrio della Forza"; colore="#3f8cff"; }
  else if(punteggi.sith>punteggi.jedi && punteggi.sith>punteggi.grigio){ esito="ðŸŸ¥ Sith â€“ la passione e il potere guidano le tue scelte"; colore="#c62828"; }

  const totale=punteggi.jedi+punteggi.sith+punteggi.grigio;
  const percJedi = ((punteggi.jedi/totale)*100).toFixed(0);
  const percSith = ((punteggi.sith/totale)*100).toFixed(0);
  const percGrigio = ((punteggi.grigio/totale)*100).toFixed(0);

  output.innerText=`Punteggi finali:\nJedi: ${punteggi.jedi} (${percJedi}%)\nSith: ${punteggi.sith} (${percSith}%)\nJedi Grigio: ${punteggi.grigio} (${percGrigio}%)\n\n${esito}`;
  output.style.color=colore;
  output.style.textShadow=`0 0 25px ${colore},0 0 50px ${colore}`;
  nextBtn.style.display="none";
  ricominciaBtn.style.display="inline-block";
  ricominciaBtn.style.background=`linear-gradient(90deg,${colore},${colore})`;
  ricominciaBtn.style.boxShadow=`0 0 20px ${colore},0 0 50px ${colore} inset`;
  progressBar.style.width="100%";

  // stelle effetto finale
  for(let i=0;i<50;i++){
    const p=document.createElement("div");
    p.style.position="absolute";
    p.style.width="6px"; p.style.height="6px"; p.style.borderRadius="50%";
    p.style.background=colore;
    p.style.left=(Math.random()*output.offsetWidth)+"px";
    p.style.top=(Math.random()*output.offsetHeight)+"px";
    p.style.opacity=Math.random();
    p.style.animation=`floatUp ${2+Math.random()*2}s ease-out forwards`;
    output.appendChild(p);
  }

  // grafico a torta
  ctxChart.clearRect(0,0,chartCanvas.width,chartCanvas.height);
  const data = [
    {label:"Jedi", value:punteggi.jedi, color:"#3f8cff"},
    {label:"Sith", value:punteggi.sith, color:"#c62828"},
    {label:"Grigio", value:punteggi.grigio, color:"#a080ff"}
  ];
  let startAngle = -0.5 * Math.PI;
  data.forEach(d=>{
    const sliceAngle = (d.value/totale) * 2 * Math.PI;
    ctxChart.beginPath();
    ctxChart.moveTo(150,150);
    ctxChart.arc(150,150,120,startAngle,startAngle+sliceAngle);
    ctxChart.closePath();
    ctxChart.fillStyle=d.color;
    ctxChart.fill();
    const midAngle = startAngle + sliceAngle/2;
    const labelX = 150 + Math.cos(midAngle)*80;
    const labelY = 150 + Math.sin(midAngle)*80;
    ctxChart.fillStyle="#fff";
    ctxChart.font="16px 'Orbitron'";
    ctxChart.textAlign="center";
    ctxChart.textBaseline="middle";
    const perc = totale===0 ? 0 : Math.round((d.value/totale)*100);
    if (perc>0) ctxChart.fillText(perc+"%", labelX, labelY);
    startAngle += sliceAngle;
  });

  // socials
  socialsDiv.innerHTML = `
    <a href="https://www.instagram.com/jgacademy.national" target="_blank"><img src="instagram.png" width="40"></a>
    <a href="https://www.instagram.com/jgacademy.pavia" target="_blank"><img src="instagram.png" width="40"></a>
    <a href="https://www.tiktok.com/@jgacademy.pavia" target="_blank"><img src="tiktok.png" width="40"></a>
  `;
  socialsDiv.style.display="flex";
}

const style=document.createElement("style");
style.innerHTML=`@keyframes floatUp {0%{transform:translateY(0);opacity:1;}100%{transform:translateY(-100px);opacity:0;}}`;
document.head.appendChild(style);

ricominciaBtn.addEventListener("click",function(){
  punteggi={jedi:0,sith:0,grigio:0};
  domandaCorrente=0;
  domande.forEach(d=>d.classList.remove("attiva"));
  domande[0].classList.add("attiva");
  document.getElementById("output").innerText="";
  document.getElementById("output").style.color="#f5f5f5";
  document.getElementById("output").style.textShadow="none";
  ctxChart.clearRect(0,0,chartCanvas.width,chartCanvas.height);
  socialsDiv.innerHTML="";
  socialsDiv.style.display="none";
  nextBtn.style.display="inline-block";
  ricominciaBtn.style.display="none";
  aggiornaProgress();
});

// ===== Stelle animate =====
const canvas=document.getElementById('stars');
const ctx=canvas.getContext('2d');
let width=canvas.width=window.innerWidth;
let height=canvas.height=window.innerHeight;
const stars=[];
const numStars=150;
for(let i=0;i<numStars;i++){ 
  stars.push({ x:Math.random()*width, y:Math.random()*height, r:Math.random()*1.5+0.5, dx:(Math.random()-0.5)/2, dy:(Math.random()-0.5)/2 }); 
}
function animateStars(){ 
  ctx.clearRect(0,0,width,height); 
  for(let s of stars){ 
    ctx.beginPath(); 
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2); 
    ctx.fillStyle="white"; 
    ctx.fill(); 
    s.x+=s.dx; s.y+=s.dy; 
    if(s.x<0)s.x=width; if(s.x>width)s.x=0; 
    if(s.y<0)s.y=height; if(s.y>height)s.y=0; 
  } 
  requestAnimationFrame(animateStars); 
}
animateStars();
window.addEventListener('resize',()=>{ width=canvas.width=window.innerWidth; height=canvas.height=window.innerHeight; });
</script>
</body>
</html>
