<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz della Forza</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<!-- Font stile sci-fi -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">

<style>
/* Corpo e sfondo */
body {
  font-family: 'Orbitron', sans-serif;
  color: #f5f5f5;
  max-width: 600px;
  margin: 0 auto;
  padding: 30px 20px;
  text-align: center;
  overflow-x: hidden;
  position: relative;
  background: black;
}

/* Canvas stelle */
#stars {
  position: fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  z-index: -1;
  background: black;
}

/* Titoli */
h1 {
  color: #ffe81f;
  letter-spacing: 2px;
  margin-bottom: 10px;
}
h2 { margin-top:0; }

/* Domande con sfondo semitrasparente */
.domanda {
  display:none;
  animation: fadeIn 0.5s ease;
  background: rgba(0,0,0,0.6);
  padding: 15px;
  border-radius: 12px;
  margin-bottom: 15px;
}
.domanda.attiva { display:block; }
@keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

/* Risposte */
label {
  display: block;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  padding: 12px;
  margin: 12px 0;
  cursor: pointer;
  transition: all 0.3s ease;
}
label:hover { background: rgba(255,255,255,0.12); }
input[type="radio"] { accent-color:#ffe81f; margin-right:10px; }

/* Pulsante */
button {
  margin-top: 25px;
  padding: 12px 30px;
  font-size: 16px;
  font-family: 'Orbitron', sans-serif;
  background: linear-gradient(90deg, #3f8cff, #1b3cff);
  border: none;
  border-radius: 30px;
  color: white;
  cursor: pointer;
  box-shadow: 0 0 15px rgba(63,140,255,0.6);
  transition: transform 0.2s, box-shadow 0.2s;
}
button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 25px rgba(63,140,255,0.9);
}

/* Barra di progresso */
#progress-container {
  width: 100%;
  height: 8px;
  background: #222;
  border-radius: 4px;
  overflow: hidden;
  margin: 20px 0 30px;
}
#progress-bar {
  height:100%;
  width:0%;
  background: linear-gradient(90deg,#3f8cff,#ffe81f,#c62828);
  transition: width 0.4s ease;
}

/* Output risultato */
#output { 
  white-space: pre-line; 
  margin-top: 20px; 
  font-size:15px;
  padding: 15px;
  border-radius: 12px;
  background: rgba(0,0,0,0.6);
}
</style>
</head>

<body>
<canvas id="stars"></canvas>

<h1>Quiz della Forza</h1>
<p style="font-size:12px; opacity:0.7;">Scopri se sei Jedi, Sith o Jedi Grigio</p>

<div id="progress-container">
  <div id="progress-bar"></div>
</div>

<!-- Domande -->
<div class="domanda attiva">
  <h2>Domanda 1: Quale lato della Forza ti attrae di piÃ¹?</h2>
  <label><input type="radio" name="q0" value="jedi"> La luce e l'equilibrio</label>
  <label><input type="radio" name="q0" value="sith"> Il potere e la passione</label>
  <label><input type="radio" name="q0" value="grigio"> Entrambi, a seconda del momento</label>
</div>

<div class="domanda">
  <h2>Domanda 2: Cosa faresti se qualcuno ti provocasse?</h2>
  <label><input type="radio" name="q1" value="jedi"> Rimango calmo e ragiono</label>
  <label><input type="radio" name="q1" value="sith"> Colpirei subito con forza</label>
  <label><input type="radio" name="q1" value="grigio"> Dipende dalla situazione</label>
</div>

<button id="next">Avanti</button>

<div id="output"></div>
<button id="ricomincia" style="display:none;">ðŸ”„ Ricomincia il Quiz</button>

<script>
// ===== Quiz logica =====
let domandaCorrente = 0;
const domande = document.querySelectorAll(".domanda");
const nextBtn = document.getElementById("next");
const ricominciaBtn = document.getElementById("ricomincia");
const progressBar = document.getElementById("progress-bar");

let punteggi = { jedi:0, sith:0, grigio:0 };

function aggiornaProgress(){
  progressBar.style.width = ((domandaCorrente)/domande.length*100)+"%";
}

nextBtn.addEventListener("click", function(){
  const selected = document.querySelector('input[name="q'+domandaCorrente+'"]:checked');
  if(!selected){ alert("Seleziona una risposta!"); return; }
  punteggi[selected.value]++;
  domande[domandaCorrente].classList.remove("attiva");
  domandaCorrente++;
  if(domandaCorrente<domande.length){
    domande[domandaCorrente].classList.add("attiva");
  } else { mostraRisultato(); }
  aggiornaProgress();
});

function mostraRisultato(){
  const output = document.getElementById("output");
  let esito="âš–ï¸ Jedi Grigio â€“ cammini tra luce e oscuritÃ ";
  let colore="#a080ff", shadow="0 0 20px #a080ff";
  if(punteggi.jedi>punteggi.sith && punteggi.jedi>punteggi.grigio){
    esito="ðŸŸ¦ Jedi â€“ segui la luce e lâ€™equilibrio della Forza";
    colore="#3f8cff"; shadow="0 0 25px #3f8cff";
  } else if(punteggi.sith>punteggi.jedi && punteggi.sith>punteggi.grigio){
    esito="ðŸŸ¥ Sith â€“ la passione e il potere guidano le tue scelte";
    colore="#c62828"; shadow="0 0 25px #c62828";
  }
  output.innerText=`Punteggi finali:\nJedi: ${punteggi.jedi}\nSith: ${punteggi.sith}\nJedi Grigio: ${punteggi.grigio}\n\n${esito}`;
  output.style.color=colore;
  output.style.textShadow=shadow;
  nextBtn.style.display="none";
  ricominciaBtn.style.display="inline-block";
  progressBar.style.width="100%";
}

ricominciaBtn.addEventListener("click", function(){
  punteggi={jedi:0,sith:0,grigio:0};
  domandaCorrente=0;
  domande.forEach(d=>d.classList.remove("attiva"));
  domande[0].classList.add("attiva");
  document.getElementById("output").innerText="";
  document.getElementById("output").style.color="#f5f5f5";
  document.getElementById("output").style.textShadow="none";
  nextBtn.style.display="inline-block";
  ricominciaBtn.style.display="none";
  aggiornaProgress();
});

// ===== Stelle animate con Canvas =====
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

const stars = [];
const numStars = 150;

// crea stelle
for(let i=0;i<numStars;i++){
  stars.push({
    x: Math.random()*width,
    y: Math.random()*height,
    r: Math.random()*1.5+0.5,
    dx: (Math.random()-0.5)/2,
    dy: (Math.random()-0.5)/2
  });
}

function animateStars(){
  ctx.clearRect(0,0,width,height);
  for(let s of stars){
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fillStyle="white";
    ctx.fill();
    s.x += s.dx;
    s.y += s.dy;

    if(s.x<0) s.x=width;
    if(s.x>width) s.x=0;
    if(s.y<0) s.y=height;
    if(s.y>height) s.y=0;
  }
  requestAnimationFrame(animateStars);
}
animateStars();

window.addEventListener('resize', ()=>{
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});

// PWA: service worker registrazione
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("service-worker.js");
}
</script>
</body>
</html>
